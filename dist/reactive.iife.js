var reactive=function(a){"use strict";var g=(t=>(t[t.CREATE=0]="CREATE",t[t.NEW=1]="NEW",t[t.UPDATE=2]="UPDATE",t[t.PREPEND=3]="PREPEND",t))(g||{});class v{constructor(e,r,n=0){this.superCtx=e,this.TYPE_ACTION=n,this.store=[],this.data=r}set data(e){const r=this.data;if(this.TYPE_ACTION===1||this.TYPE_ACTION===0?this._current=e:this.TYPE_ACTION===2?this._current=e:this.TYPE_ACTION===3&&(this.rendering=e),this.TYPE_ACTION!==3){if(this.store.includes(e))return;this.TYPE_ACTION===2?this.store.push(this._current=[...r,...this._current]):this.store.push(this._current)}}get data(){return this._current}get previousData(){return this.store.at(-1)}toString(){var e,r;return(r=(e=this.data)==null?void 0:e.toString())!=null?r:""}}function D(t,e,r){e.TYPE_ACTION=1,e.data=t}class d{constructor(e,r){this.superCtx=r,this.store=new Map,this.currentStoreState=new v(r,e)}get parentNode(){return this.currentParentNode}set parentNode(e){this.currentParentNode=e,typeof this.currentStoreState.parentNode!="undefined"&&this.currentStoreState.parentNode!==e&&(this.currentStoreState=new v(this.superCtx,this.currentStoreState.data)),this.currentStoreState.parentNode=e,this.store.set(e,this.currentStoreState)}get data(){return this.currentStoreState.data}addProxySelf(e){return this.proxySelf=e,this}set(e){D(e,this.currentStoreState)}append(e){D(e,this.proxySelf?this.proxySelf.currentStoreState:this.currentStoreState)}$setReturnData(e){return this.currentStoreState.TYPE_ACTION=3,this.currentStoreState.data=e,this}$map(e){if(Array.isArray(this.data))return this.currentStoreState.TYPE_ACTION=3,this.currentStoreState.data=this.data.map(e);throw new Error("data is not array")}is(e){return this.currentStoreState.data===e}toString(){return this.currentStoreState.toString()}[Symbol.toPrimitive](){return this.toString()}*[Symbol.iterator](){for(const e of this.currentStoreState.data)yield e}}class Y extends Text{constructor(e){super(e)}get text(){return this.data}set text(e){this.data=e}}class Z{constructor(){this.resetWidgets=e=>{for(const r of e)r.innerHTML=""}}replaceChild(e,r,n){if(r.length===n.length)n.forEach((i,s)=>{i.replaceWith(r[s])});else if(n.length===1)n.at(0).replaceWith(...r);else{let i=n.at(-1).nextSibling;n.forEach(s=>s.remove()),r.forEach(s=>{e.insertBefore(s,i)})}}setText(e,r){e.textContent=r}createText(e){return new Y(e)}createWidget(e,r){return r?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e)}appendWidget(e,r){e.append(...Array.isArray(r)?r:[r])}setProperties(e,r){for(const n in r){const i=r[n];n.startsWith("on")?e.addEventListener(n.slice(2).toLowerCase(),i):e.setAttribute(n==="className"?"class":n,String(i))}}querySelector(e){return document.querySelector(e)}updateWidget(e){var r;const n=e.node.childNodes,i=n.item(e.updateIndex),s=i==null?void 0:i.previousSibling;if(!e.state)return;if(e.isStringable)return i.data=e.state;const o=Array.from(n).slice(e.updateIndex).slice(0,e.totalChilds),u=(r=o.at(-1))==null?void 0:r.nextSibling;if(e.typeAction===g.NEW){for(let S=0;S<o.length;S++)o[S].remove();if(n.length===0||!i&&!s&&!u)return e.node.append(...e.state);if(i.parentNode)return i.before(...e.state);if(u&&!i.parentNode)return u.before(...e.state);s.after(...e.state)}else e.typeAction===g.UPDATE&&e.node.append(...e.state)}}const w=new Map,c={createStore(t){w.has(t)||(w.set(t,new Map),Object.defineProperty(c,t,{get(){return w.get(t)}}))}};c.createStore("tickets");function N(t){const e=t.queue.at(t.ticket);return t.ticket+=1,t.queue.length===t.ticket&&(t.ticket=0),e}function E(t){return c.tickets.has(t)||c.tickets.set(t,{reInvoke:!1,ticket:0,queue:[]}),c.tickets.get(t)}c.createStore("callbacks");function j(t,e){const r=E(e);return r.reInvoke?N(r):(r.queue.push(t),t)}c.createStore("memo");function T(t,e){const r=j(t,e);return c.memo.has(r)||c.memo.set(r,!1),(...n)=>(c.memo.get(r)===!1&&c.memo.set(r,r(...n)),c.memo.get(r))}c.createStore("states");function A(t){const e=E(t);return e.reInvoke?N(e):e}function ee(t,e){return typeof t[e]=="function"?t[e].bind(t):t[e]}function C(t,e){const r=e?A(e):void 0;if(r instanceof d)return r;const n=new Proxy(new d(t,e),{get(i,s){if(s==="flatten")return r;if(s in i)return ee(i,s);if(typeof i.data[s]!="undefined")return!Array.isArray(i.data)&&i.data instanceof Object?i.data[s]:typeof i.data[s]=="function"?(...o)=>{if(typeof i.data[s].apply(i.data,o)!="undefined")return i.$setReturnData(i.data[s].apply(i.data,o))}:n;throw new Error("error proxy "+s)},set(i,s,o){if(s in i)i[s]=o;else if(s in i.data)i.data[s]=o;else return!1;return!0}});return typeof r=="object"&&r.queue.push(n),n}function te(t,e){const{state:r,callback:n,option:i}=t!=null?t:{};return n?n.call(this,{state:r,option:i,children:e}):e}let y;const q=t=>t.find(e=>re(e.properties));function re({path:t}){const e=location.hash.length&&location.hash.startsWith("#")?location.hash.slice(1):"/",n=new globalThis.URLPattern(t,location.origin).exec(e,location.origin);return y=n?{path:n.input,params:n.groups}:null,y!==null}function ne({children:t,notFount:e}){const r=C(!1,this),n=C(r.data?e:q(t),this);return T(()=>{this.implementStates(n),window.addEventListener("hashchange",()=>{var i;r.data===!1&&r.set(!0),n.set((i=q(t))!=null?i:e)})},this)(),n.data.parentNode||(n.data.parentNode=this),n.data}function ie(t){return t.render.parentNode=this,t.render}function se(){return y.params}function ae(){return y.path}function U(t){let e=t.flatten;t.currentStoreState.superCtx&&!e&&(e=A(t.currentStoreState.superCtx)),e&&!(e instanceof d)&&(e.reInvoke=!0)}function L(t,e=Function){for(const r of t){const n=r.set.bind(r),i=r.append.bind(r);r.set=s=>{U(r),n(s),e(r)},r.append=s=>{U(r),i(s),e(r)}}}function oe(...t){var e;for(const r of t){const[n,i]=Array.isArray(r)?r:[r],s=(e=n.currentStoreState.superCtx)!=null?e:i;if(typeof s=="undefined")throw new Error("el estado no tiene el contexto del componente");T(()=>{i&&(n.currentStoreState.superCtx=s),s.implementStates(n)},s)()}}function m(t){return Array.isArray(t)?t:[t]}function f(t){return typeof t.type=="string"?m(t.node):t.childs.map(M).flat()}function M(t){return t.node?t.node:ce(t).flat()}function ce(t){const e=[];for(const r of t.childs){let n=r;r instanceof X&&(n=M(r)),e.push(n)}return e}function F(t){let e=t;for(;e&&typeof e.node!="object";)e=e.parentNode;return e}function _(t=!1){const e={};t&&(e.children=this.originalChilds);for(const r in this.properties)t&&r==="shareContext"?e.sharedContext=this.properties[r]:e[r==="className"?"class":r]=this.properties[r];return e}var de=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},h=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},l=(t,e,r)=>(de(t,e,"access private method"),r),P,$,b,V,W,B,I,z,R,G,H,J,k,K;const ue=["string","number","boolean"],Q={pos:0,current:0},p=class O{constructor(e,r,n,i){this.type=e,this.properties=r,this.widgedHelper=n,this.originalChilds=i,h(this,P),h(this,b),h(this,W),h(this,I),h(this,R),h(this,H),h(this,k),this.isReInvoke=!1,this.node=void 0,this.parentNode=void 0,this.childs=void 0,this._id=Q.pos,this._ns=!1,this._fnparent=void 0,typeof this.type=="string"&&this.type==="svg"&&(this._ns=!0);for(let s of i)this._ns&&s instanceof O&&(s._ns=!0),typeof this.type=="function"&&s instanceof O&&(s._fnparent=this);Q.pos++}createNodeAndChilds(){typeof this.type=="string"&&(this.node=this.widgedHelper.createWidget(this.type,this._ns),this.childs=m(this.originalChilds))}render(){if(this.node&&(this.widgedHelper.setProperties(this.node,_.call(this)),this.isReInvoke&&this.widgedHelper.resetWidgets&&this.widgedHelper.resetWidgets(f(this))),typeof this.type=="function"&&!this.childs){const e=_.call(this,!0),r=this.type.name==="Fragment"?this.type(e):this.type.call(this,e);this.childs=m(r)}return l(this,R,G).call(this),this}getNodeWidget(){return typeof this.node=="object"?this:F(this)}implementStates(...e){L(e,r=>{l(this,k,K).call(this,r.currentStoreState)})}};P=new WeakSet,$=function(t){if(t instanceof d&&!l(this,b,V).call(this,t))throw new Error("the execution of a state without an executing function is only allowed if they are strings, numbers or boolean values")},b=new WeakSet,V=function(t){return Array.isArray(t.data)?t.data.some(e=>typeof e=="object")===!1:ue.includes(typeof t.data)},W=new WeakSet,B=function(t){var e,r;const n=typeof this.type=="function"?F(this):this,i=n.childs;for(let s=0,o;o=i[s];s++){if(this!==o||!(o instanceof d&&o.data===t.data))continue;l(this,P,$).call(this,o);const u={isStringable:!1,node:n.node,typeAction:t.TYPE_ACTION,updateIndex:s};o instanceof d&&Object.assign(u,{isStringable:!0,state:t.data,totalChilds:i.length}),o instanceof p&&typeof o.type=="function"&&(o.type.call(this,_.call(this,!0)),t.parentNode&&(u.state=(r=(e=t.rendering)==null?void 0:e.map(S=>f(S.render())).flat())!=null?r:f(t.data)),u.totalChilds=t.previousData.length),this.widgedHelper.updateWidget(u)}},I=new WeakSet,z=function(t){t.isReInvoke=!0;const e=t.type.call(t,_.call(t,!0)),r=f(t);let n;if(e instanceof p)e.isReInvoke=!0,e.render(),n=f(e),e.parentNode=t;else if(Array.isArray(e))n=e.map(i=>f(i.render()).at(0));else throw new Error("could not resolve nodes");this.widgedHelper.replaceChild(this.getNodeWidget().node,n,r),t.childs=m(e)},R=new WeakSet,G=function(){const t=this.getNodeWidget();for(let e of this.childs)(e instanceof p||e instanceof d)&&(e.parentNode=this),e instanceof p?(typeof this.type=="function"?e._fnparent=this.type.name!=="Fragment"?this:this._fnparent:typeof this.type=="string"&&this._fnparent&&(e._fnparent=this._fnparent),typeof e.type=="string"&&this._ns&&(e._ns=!0,e.createNodeAndChilds()),this.isReInvoke&&(e.createNodeAndChilds(),e.isReInvoke=!0),t&&typeof e.node=="object"&&this.widgedHelper.appendWidget(t.node,e.node),e.render()):e instanceof d?(L([e]),t&&l(this,H,J).call(this,this,t.node,e)):t&&this.widgedHelper.appendWidget(t.node,this.widgedHelper.createText(e))},H=new WeakSet,J=function(t,e,r){var n;const i=r.currentStoreState;Array.isArray(i.data)||Array.isArray(i.rendering)?((n=i.rendering)!=null?n:i.data).forEach(s=>{this.widgedHelper.appendWidget(e,s instanceof p?s.render().node:s)}):this.widgedHelper.appendWidget(e,r)},k=new WeakSet,K=function(t){return t.superCtx?l(this,I,z).call(this,t.superCtx):l(this,W,B).call(this,t)};let X=p,x;function he(t){x=t}class le{static Fragment({children:e}){return e}static createElement(e,r,...n){const i=Object.seal(new X(e,r||{},x,n));return i.createNodeAndChilds(),i}}function fe(t,e){return e.node=x.querySelector(t),e.render(),console.log(e),e}return a.Execute=te,a.HookStore=c,a.Reactive=le,a.ReactiveText=Y,a.Route=ie,a.Routes=ne,a.State=d,a.StateAction=g,a.StoreState=v,a.WidgetHelper=Z,a.addWidgetHelper=he,a.createTicket=E,a.exec=T,a.flattenState=A,a.implementStates=oe,a.nextTicket=N,a.render=fe,a.useCallback=j,a.useParams=se,a.usePath=ae,a.useState=C,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),a}({});
