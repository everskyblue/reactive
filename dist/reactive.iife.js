var reactive=function(o){"use strict";const y=new Map,c={createStore(e){y.has(e)||(y.set(e,new Map),Object.defineProperty(c,e,{get(){return y.get(e)}}))}};c.createStore("tickets");function w(e){const t=e.queue.at(e.ticket);return e.ticket+=1,e.queue.length===e.ticket&&(e.ticket=0),t}function N(e){c.tickets.has(e)||c.tickets.set(e,{reInvoke:!1,ticket:0,queue:[]});const t=c.tickets.get(e);return e.isReInvoke&&(t.reInvoke=!0),t}c.createStore("callbacks");function A(e,t){const n=N(t);return n.reInvoke?w(n):(n.queue.push(e),e)}c.createStore("memo");function v(e,t){const n=A(e,t);return c.memo.has(n)||c.memo.set(n,!1),(...i)=>(c.memo.get(n)===!1&&c.memo.set(n,n(...i)),c.memo.get(n))}c.createStore("states");function _(e){const t=N(e);return t.reInvoke?w(t):t}var H=(e=>(e[e.CREATE=0]="CREATE",e[e.NEW=1]="NEW",e[e.UPDATE=2]="UPDATE",e[e.PREPEND=3]="PREPEND",e))(H||{});class h{constructor(t,n){this.state=n,this._parentNode=null,this.node=null,this.node=t.map(i=>i.render())}set parentNode(t){this._parentNode=t,t.implementStates(this.state)}get parentNode(){return this._parentNode}}class O{constructor(t,n,i=0){this.superCtx=t,this.TYPE_ACTION=i,this.store=[],this.data=n}set data(t){if(this.TYPE_ACTION===3&&(this.rendering=t),this.TYPE_ACTION!==3){if(this.store.includes(t))return;this.store.push(t)}}get data(){return this.store.at(-1)}get previousData(){return this.store.at(-2)}toString(){var t,n;return(n=(t=this.data)==null?void 0:t.toString())!=null?n:""}}function G(e,t,n){t.TYPE_ACTION=n,t.data=e}class u{constructor(t,n){this.store=new Map,this.currentStoreState=new O(n,t)}get parentNode(){return this.currentParentNode}get superCtx(){return this.currentStoreState.superCtx}get previousData(){return this.currentStoreState.previousData}set parentNode(t){}get data(){return this.currentStoreState.data}addProxySelf(t){return this.proxySelf=t,this}set(t){G(t,this.currentStoreState,1)}is(t){return this.currentStoreState.data===t}toString(){return this.currentStoreState.toString()}[Symbol.toPrimitive](){return this.toString()}*[Symbol.iterator](){for(const t of this.currentStoreState.data)yield t}}function J(e,t){return typeof e[t]=="function"?e[t].bind(e):e[t]}function C(e,t){const n=t?_(t):void 0;if(n instanceof u)return n;const i=new Proxy(new u(e,t),{get(r,s){if(s==="flatten")return n;if(s in r)return J(r,s);if(typeof r.data[s]!="undefined")return!Array.isArray(r.data)&&r.data instanceof Object?r.data[s]:typeof r.data[s]=="function"?(...d)=>{if(typeof r.data[s].apply(r.data,d)!="undefined")return new h(r.data[s].apply(r.data,d),i)}:i;throw new Error("error proxy "+s)},set(r,s,d){if(s in r)r[s]=d;else if(s in r.data)r.data[s]=d;else return!1;return!0}});return typeof n=="object"&&n.queue.push(i),i}function K(e,t){const{state:n,callback:i,option:r}=e!=null?e:{};return i?i.call(this,{state:n,option:r,children:t}):t}let S;const D=e=>e.find(t=>Q(t.properties));function Q({path:e}){const t=location.hash.length&&location.hash.startsWith("#")?location.hash.slice(1):"/",i=new globalThis.URLPattern(e,location.origin).exec(t,location.origin);return S=i?{path:i.input,params:i.groups}:null,S!==null}function X({children:e,notFount:t}){const n=C(!1,this),i=C(n.data?t:D(e),this);return v(()=>{this.implementStates(i),window.addEventListener("hashchange",()=>{var r;n.data===!1&&n.set(!0),i.set((r=D(e))!=null?r:t)})},this)(),i.data.parentNode||(i.data.parentNode=this),i.data}function Z(e){return e.render.parentNode=this,e.render}function $(){return S.params}function x(){return S.path}function ee(e){let t=e.flatten;e.currentStoreState.superCtx&&!t&&(t=_(e.currentStoreState.superCtx)),t&&!(t instanceof u)&&(t.reInvoke=!0)}function q(e,t=()=>{}){for(const n of e){const i=n.set.bind(n);n.set=r=>{ee(n),i(r),t(n)}}}function te(e,t){v(()=>{q(t,n=>{T.call(e,n.currentStoreState)})},e)()}function W(e){return Array.isArray(e)?e:[e]}function L(e){return typeof e.type=="string"?W(e.node):e.childs.map(l).flat()}function l(e){return e.node?e.node:ne(e).flat()}function ne(e){const t=[];for(const n of e.childs){let i=n;n instanceof f&&(i=l(n)),t.push(i)}return t}function M(e){let t=e;for(;t&&typeof t.node!="object";)t=t.parentNode;return t}function P(e=!1){const t={};e&&(t.children=this.originalChilds);for(const n in this.properties)e&&n==="shareContext"?t.sharedContext=this.properties[n]:t[n==="className"?"class":n]=this.properties[n];return t}var ie=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},p=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},j=(e,t,n)=>(ie(e,t,"access private method"),n),U,Y,E,V,B,R,F;function T(e){this.isReInvoke=!0;const t=this.parentNode,n=typeof this.type=="function"?M(this):this,i=this.childs;let r=i.findIndex(m=>m instanceof f||m instanceof u||m instanceof h&&m.state.currentStoreState===e);const s=i[r],d=s instanceof f?[s]:s instanceof h?s.node:s.toString();typeof this.type=="function"&&(i[r]=this.type.call(this,P.call(this,!0)));const a=i[r],g=a instanceof f;g&&(a.parentNode=this);const ce=g?[a.render()]:a instanceof u?a.toString():a.node;this.widgedHelper.updateWidget(new class{getNodeParent(){return n.node}getParent(){return t}get index(){return r}get newChilds(){return ce}get oldChilds(){return d}})}const z={pos:0,current:0},b=class I{constructor(t,n,i,r){this.type=t,this.properties=n,this.widgedHelper=i,this.originalChilds=r,p(this,U),p(this,Y),p(this,E),p(this,B),p(this,R),this.isReInvoke=!1,this.node=void 0,this.parentNode=void 0,this.childs=void 0,this._id=z.pos,this._ns=!1,this._fnparent=void 0,this._listenerOnCreate=()=>{},typeof this.type=="string"&&this.type==="svg"&&(this._ns=!0),n&&n.onCreate&&(this._listenerOnCreate=n.onCreate,delete this.properties.onCreate);for(let s of r)this._ns&&s instanceof I&&(s._ns=!0),typeof this.type=="function"&&s instanceof I&&(s._fnparent=this);z.pos++}createNodeAndChilds(){typeof this.type=="string"&&(this.node=this.widgedHelper.createWidget(this.type,this._ns),this.childs=W(this.originalChilds))}render(){if(this.node&&(this.widgedHelper.setProperties(this.node,P.call(this)),this.isReInvoke&&this.widgedHelper.resetWidgets&&this.widgedHelper.resetWidgets(L(this))),typeof this.type=="function"&&!this.childs){const t=P.call(this,!0),n=this.type.name==="Fragment"?this.type(t):this.type.call(this,t);this.childs=W(n)}return j(this,E,V).call(this),this._listenerOnCreate(this.node),this}getNodeWidget(){return typeof this.node=="object"?this:M(this)}implementStates(...t){q(t,n=>{j(this,R,F).call(this,n.currentStoreState)})}};U=new WeakSet,Y=new WeakSet,E=new WeakSet,V=function(){this.getNodeWidget();for(let e of this.childs)(e instanceof b||e instanceof u||e instanceof h)&&(e.parentNode=this),e instanceof b?(typeof this.type=="function"?e._fnparent=this.type.name!=="Fragment"?this:this._fnparent:typeof this.type=="string"&&this._fnparent&&(e._fnparent=this._fnparent),typeof e.type=="string"&&this._ns&&(e._ns=!0,e.createNodeAndChilds()),this.isReInvoke&&(e.createNodeAndChilds(),e.isReInvoke=!0),e.render(),this.widgedHelper.appendWidget(this,e)):e instanceof h?this.widgedHelper.appendWidget(this,e):this.widgedHelper.appendWidget(this,e instanceof u?(this.implementStates(e),e.toString()):e)},B=new WeakSet,R=new WeakSet,F=function(e){return e.superCtx?T.call(e.superCtx,e):T.call(this,e)};let f=b,k;function re(e){k=e}class se{static Fragment({children:t}){return t}static createElement(t,n,...i){const r=Object.seal(new f(t,n||{},k,i));return r.createNodeAndChilds(),r}}function oe(e,t){return t.node=k.querySelector(e),t.render(),t}const ae=typeof window!="undefined";class de{constructor(){this.resetWidgets=t=>{for(const n of t)n.innerHTML=""}}createWidget(t,n){return n?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t)}appendWidget(t,n){if(ae){if(typeof n.type=="function")return;const i=t.getNodeWidget(),r=n instanceof f?L(n):n instanceof h?n.node.map(l):n;Array.isArray(r)?i.node.append(...r):i.node.append(r)}}setProperties(t,n){for(const i in n){const r=n[i];i.startsWith("on")?t.addEventListener(i.slice(2).toLowerCase(),r):t.setAttribute(i==="className"?"class":i,String(r))}}querySelector(t){return document.querySelector(t)}updateWidget(t){var n;const i=t.getNodeParent();let{index:r,oldChilds:s,newChilds:d}=t;if(typeof d=="string")i.childNodes.item(r).data=d;else{d=d.map(a=>l(a)),s=s.map(a=>l(a)),d.length>s.length;for(let a=0;a<d.length;a++){const g=d[a];s[a]?s[a].replaceWith(g):i.insertBefore(g,(n=d[a-1])==null?void 0:n.nextSibling)}}}}return o.Execute=K,o.HookStore=c,o.NativeRender=de,o.Reactive=se,o.Route=Z,o.Routes=X,o.State=u,o.StateAction=H,o.StateRender=h,o.StoreState=O,o.addWidgetHelper=re,o.createTicket=N,o.exec=v,o.flattenState=_,o.implementStates=te,o.nextTicket=w,o.render=oe,o.useCallback=A,o.useParams=$,o.usePath=x,o.useState=C,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),o}({});
